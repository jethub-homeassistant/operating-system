image emmc.img {

	image kernel.img {
	size = ${KERNEL_SIZE}
	srcpath = "${BINARIES_DIR:-PLEASE_SPECIFY_BINARIES_DIR}/${KERNEL_FILE:-PLEASE_SPECIFY_KERNEL_FILE}"

		squashfs {
			compression = "lzo"
			block-size = 131072
		}
	}

	image overlay.ext4 {
		size = ${OVERLAY_SIZE}
		empty = "yes"

		ext4 {
			use-mke2fs = "yes"
			label = "os-overlay"
			extraargs = "-I 256 -E lazy_itable_init=0,lazy_journal_init=0"
		}
	}

	hdimage {
	partition-table-type = "mbr"
	align = 1M
	disk-signature = 0x48617373
	extended-partition = 2
	}

	partition uboot {
		partition-type = 0xc
		bootable = "yes"
		offset = 0
		size = 4M
		image = "boot.vfat"
	}

	partition reserved {
		offset = 4M
		size = 124M
	}

	partition env {
		offset = 128M
    	size = 2M
	}

	partition rootA {
		offset = 130M
		size = 256M
		image = ${SYSTEM_IMAGE}
	}

	partition rootB {
		offset = 386M
		size = 256M
		image = ${SYSTEM_IMAGE}
	}

	partition overlay {
		partition-type = 0x83
		offset = 642M
    	size = 64M
    	image = "overlay.ext4"

	}

	partition reserved_end {
		offset = 706M
    	size = 318M
    	partition-type = 0x83
	}
}

